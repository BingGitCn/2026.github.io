<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <title>有Bing呀 · 搜一下</title>
  
  <!-- 引入 Ma Shan Zheng (马善政) 书法字体 -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <!-- <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&display=swap" rel="stylesheet"> -->

  <!-- 引入诗词接口 -->
  <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>

  <style>
    /* --- 基础设置 --- */
    * { padding: 0; margin: 0; outline: none; -webkit-tap-highlight-color: transparent; box-sizing: border-box; } 
    
    html, body {
        width: 100%; height: 100%;
        position: relative; overflow: hidden;
        background: #f3e9d2; 
        font-family: -apple-system, BlinkMacSystemFont, "San Francisco", "PingFang SC", "Microsoft YaHei", "Segoe UI", Roboto, sans-serif;
        font-weight: 300; color: #333;
        --theme-color: #f3e9d2;
    }
    
    /* 诗词专用字体 */
      .calligraphy-font {
      font-family:
          "STXingkai",
          "Xingkai SC",
          "STKaiti",
          "KaiTi",
          "楷体",
          cursive;
  }


    form, input, button { padding: 0; margin: 0; border: none; outline: none; background: none; }
    ul, li { display: block; list-style: none; }
    a { text-decoration: none; color: #333; }
    input::-webkit-input-placeholder { color: #999; letter-spacing: 1px; font-size: 14px; }
    .icon-svg { width: 1em; height: 1em; fill: currentColor; vertical-align: middle; margin-right: 4px; }

    /* --- 背景色 --- */
	/* 暖色系 */
	.bg-lotus { background: #f3e9d2; --theme-color: #f3e9d2; }      /* 莲花米 */
	.bg-apricot { background: #e0d7c5; --theme-color: #e0d7c5; }   /* 杏色 */
	.bg-peach { background: #fde2e4; --theme-color: #fde2e4; }     /* 桃粉 */
	.bg-autumn { background: #ead2ac; --theme-color: #ead2ac; }   /* 秋黄 */
	.sunset { background: #ffecd2; --theme-color: #ffecd2; }        /* 夕阳橙 */
	.goose { background: #fef9e7; --theme-color: #fef9e7; }        /* 鹅黄 */
	.rose { background: #fce4ec; --theme-color: #fce4ec; }         /* 玫瑰粉 */

	/* 绿色系 */
	.bg-bamboo { background: #d4e4bc; --theme-color: #d4e4bc; }    /* 竹绿 */
	.mint { background: #e8f5e9; --theme-color: #e8f5e9; }         /* 薄荷绿 */
	.olive { background: #dcedc8; --theme-color: #dcedc8; }       /* 橄榄绿 */
	.teal { background: #e0f2f1; --theme-color: #e0f2f1; }         /* 青瓷 */

	/* 蓝色系 */
	.bg-cloud { background: #e8f4f8; --theme-color: #e8f4f8; }      /* 云白 */
	.sky { background: #e3f2fd; --theme-color: #e3f2fd; }          /* 天蓝 */
	.ocean { background: #e1f5fe; --theme-color: #e1f5fe; }        /* 海洋蓝 */

	/* 紫色系 */
	.lavender { background: #f3e5f5; --theme-color: #f3e5f5; }     /* 薰衣草紫 */
	.wisteria { background: #ede7f6; --theme-color: #ede7f6; }     /* 紫藤 */

	/* 灰色系 */
	.foggy { background: #f5f5f5; --theme-color: #f5f5f5; }        /* 雾霾灰 */


    /* --- 菜单与侧边栏 --- */
    #menu {
        position: absolute; right: 10px; top: 10px; z-index: 2000;
        cursor: pointer; transition: 0.3s;
        display: flex; align-items: center; justify-content: center;
        background: rgba(255,255,255, 0.4); 
        backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
        padding: 0 15px; border-radius: 25px;
        height: 40px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); font-size: 14px; color: #555; font-weight: bold; 
        border: 1px solid rgba(255, 255, 255, 0.6);
    }
    #menu svg { width: 20px; height: 20px; fill: #555; margin-right: 5px; transition: 0.3s; }
    #menu.on { 
        background: rgba(255, 255, 255, 0.6); 
        color: #8b4513; 
        border-color: #8b4513;
    }
    #menu.on svg { fill: #8b4513; transform: rotate(90deg); }

    .list {
        width: 300px; height: 100%; overflow: hidden; overflow-y: auto;
        position: absolute; right: 0; top: 0; z-index: 1900;
        background: rgba(255, 255, 255, 0.7); 
        backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
        border-left: 1px solid rgba(255, 255, 255, 0.8); box-shadow: -5px 0 15px rgba(0,0,0,0.05);
        transition: 0.3s all ease;
    }
    .list.closed { right: -320px; } 
    .list ul { width: 280px; padding: 20px 0; margin-bottom: 20px; margin-left: 10px; }
    .list ul li {
        float: left; margin: 5px; width: 110px; height: 36px;
        text-align: left; line-height: 36px; font-size: 13px;
    }
    .list ul li a {
        width: 100%; border-radius: 18px; transition: 0.2s; height: 100%;
        display: block; color: #333; font-weight: 500; background: rgba(255,255,255, 0.4); text-align: left; padding-left: 10px;
    }
    .list ul li:hover a { 
        background: rgba(139, 69, 19, 0.1); 
        color: #8b4513; 
        border: 1px solid rgba(139, 69, 19, 0.2);
    }
    .list ul li.title {
        width: 100%; height: 40px; line-height: 40px; margin: 10px 0;
        text-align: left; padding-left: 10px; border-bottom: 1px solid rgba(0,0,0,0.05);
        color: #555; font-size: 16px; font-weight: bold; clear: both; float: none;
    }

    /* --- 主内容区域 --- */
    #content {
        width: 100%; height: 100%;
        position: relative; z-index: 10;
        display: flex; flex-direction: column;
        justify-content: center; align-items: center;
        padding-bottom: 80px;
        /* 修改点1：移除右侧padding，确保绝对居中 */
        padding-right: 0; 
    }
    
    /* 包裹容器，确保内部元素整体居中 */
    .con {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 100%;
    }

    .shlogo { width: 100%; text-align: center; margin-bottom: 15px; }
    .poem-sentence { font-size: 32px; color: #2c3e50; letter-spacing: 2px; margin-bottom: 5px; text-shadow: 0 2px 4px rgba(0,0,0,0.05); }
    .poem-info { font-size: 15px; color: #666; }

    /* --- 搜索框 --- */
    .sou {
        max-width: 680px; width: 90%; min-width: 320px;
        margin: 10px auto; position: relative; z-index: 20;
    }
    .sou form { width: 100%; height: 50px; display: block; margin: 10px auto 20px; position: relative; }
    .sou form .wd {
        width: 100%; height: 100%; display: block; border: 1px solid rgba(255,255,255,0.8); 
        border-radius: 25px; line-height: 100%; text-indent: 20px; font-size: 16px;
        background: rgba(255, 255, 255, 0.4); 
        box-shadow: 0 4px 15px rgba(0,0,0,0.05); transition: all 0.3s;
    }
    .sou form .wd:focus { 
        background: rgba(255, 255, 255, 0.6); 
        box-shadow: 0 4px 20px rgba(0,0,0,0.1); 
        border-color: #fff;
    }
    .sou-btn { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); cursor: pointer; color: #8b4513; font-size: 18px; }
    
    .sou ul { height: 40px; margin: 0 auto; display: flex; justify-content: center; gap: 10px; }
    .sou ul li {
        padding: 0 20px; height: 36px; line-height: 36px; text-align: center; cursor: pointer;
        background: rgba(255, 255, 255, 0.3); 
        border-radius: 18px; font-size: 13px; color: #555;
        border: 1px solid rgba(255, 255, 255, 0.5); transition: all 0.2s;
        display: flex; align-items: center; justify-content: center;
    }
    .sou ul li svg { margin-right: 5px; width: 16px; height: 16px; fill: currentColor; }
    
    .sou ul li:hover { background: rgba(255, 255, 255, 0.5); }
    .sou ul li.active {
        background: rgba(139, 69, 19, 0.1); 
        color: #8b4513; 
        border-color: rgba(139, 69, 19, 0.3); 
        font-weight: bold;
    }

    /* --- 仪表盘 --- */
    .dashboard-container { width: 90%; max-width: 1000px; display: flex; gap: 20px; margin-top: 10px; justify-content: center; }
    .glass-card {
        background: rgba(255, 255, 255, 0.5); 
        backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.6); 
        border-radius: 20px;
        padding: 20px; box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.05); color: #444;
        /* 修改点2：添加自适应限制 */
        flex: 1 1 auto;
        width: 100%;
    }
    
    /* 日历 */
    .calendar-panel { max-width: 600px; } 
    .cal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
    .cal-title { font-weight: bold; font-size: 1.1rem; }
    .cal-nav-btn {
        width: 28px; height: 28px; border-radius: 50%; border: 1px solid rgba(0,0,0,0.1); background: rgba(255, 255, 255, 0.5); cursor: pointer; color: #555; transition: 0.2s;
    }
    .cal-nav-btn:hover { background: rgba(139, 69, 19, 0.2); color: #8b4513; border-color: rgba(139, 69, 19, 0.4); }
    .cal-grid { display: grid; grid-template-columns: repeat(7, 1fr); text-align: center; font-size: 12px; }
    .cal-weekday { padding-bottom: 8px; color: #777; font-size: 0.8rem; }
    .cal-day {
        aspect-ratio: 1; display: flex; flex-direction: column; align-items: center; justify-content: center;
        border-radius: 12px; cursor: pointer; transition: 0.2s; font-size: 0.95rem; color: #333;
        /* 默认不加粗 */
        font-weight: normal; 
    }
    .cal-day:hover { background: rgba(255, 255, 255, 0.6); }
    /* 修改点3：只有今天加粗 */
    .cal-day.today { background: rgba(139, 69, 19, 0.15); color: #8b4513; font-weight: bold; box-shadow: 0 0 0 1px rgba(139, 69, 19, 0.2); }
    
    /* 修改点3：农历初一不再加粗 */
    .cal-day.lunar-first { color: #d35400; } 
    .cal-lunar { font-size: 0.7rem; color: #888; margin-top: 2px; }
    .cal-day.today .cal-lunar { color: #8b4513; }

    /* 时间板块 */
    .time-panel { max-width: 300px; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
    .time-clock {
        font-size: 3.5rem; color: #333; font-weight: 200; line-height: 1.2;
    }
    .time-ganzhi { font-size: 1.4rem; color: #555; margin: 5px 0; letter-spacing: 2px; }
    .time-solar {
        background: rgba(139, 69, 19, 0.08); padding: 5px 15px; border-radius: 15px;
        color: #8b4513; font-weight: bold; font-size: 1rem; margin: 5px 0;
        display: inline-block;
    }
    .time-date { color: #888; font-size: 0.9rem; margin-top: 5px; }

    .foot { position: absolute; bottom: 10px; z-index: 100; text-align: center; width: 100%; color: #999; font-size: 12px; }

    /* --- 山峦背景 --- */
    .landscape-container {
        position: fixed; bottom: 0; left: 0; width: 100%; height: 300px;
        overflow: hidden; z-index: 0; pointer-events: none;
    }
    .mountain-layer {
        position: absolute; bottom: 0; left: 0; width: 200%; height: 100%;
        background-repeat: repeat-x; background-position: bottom;
        background-color: var(--theme-color); 
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 320' preserveAspectRatio='none'%3E%3Cpath d='M0,192 C150,120 300,150 450,180 C600,210 750,160 900,190 C1050,220 1150,160 1200,180 V320 H0 Z' fill='%23ffffff'/%3E%3C/svg%3E");
    }
    .layer-1 { z-index: 1; opacity: 0.4; animation: moveMountain 40s linear infinite; }
    .layer-2 { z-index: 2; opacity: 0.6; animation: moveMountain 25s linear infinite reverse; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 320' preserveAspectRatio='none'%3E%3Cpath d='M0,240 C100,180 200,210 400,200 C600,190 800,140 1000,160 C1100,170 1150,140 1200,150 V320 H0 Z' fill='%23ffffff'/%3E%3C/svg%3E"); }
    .layer-3 { z-index: 3; opacity: 0.8; animation: moveMountain 15s linear infinite; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 320' preserveAspectRatio='none'%3E%3Cpath d='M0,280 C200,220 400,250 600,240 C800,230 1000,200 1200,210 V320 H0 Z' fill='%23ffffff'/%3E%3C/svg%3E"); }
    .fog {
        position: absolute; bottom: 0; left: 0; width: 100%; height: 100%;
        background: linear-gradient(to top, rgba(255, 255, 255, 0.8) 0%, rgba(255, 255, 255, 0) 60%);
        z-index: 4;
    }
    @keyframes moveMountain { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }

    /* --- 响应式调整 --- */
    @media (max-width: 768px) {
        /* 强制换行，自适应列宽 */
        .dashboard-container { 
            flex-direction: column; 
            padding-bottom: 20px; 
            align-items: center; 
        }
        .glass-card { width: 100%; max-width: 100%; }
        
        .list { width: 260px; }
        .list ul { width: 250px; }
        .sou ul li { padding: 0 12px; font-size: 12px; }
        .poem-sentence { font-size: 20px; }
        .time-clock { font-size: 2.5rem; }
        #menu { width: 40px; padding: 0 10px; }
        #menu span { display: none; }
    }
    @media (max-width: 480px) {
        .landscape-container { height: 200px; }
        .time-panel { margin-top: 20px; }
        /* 手机端调整间距 */
        .sou { margin: 10px 0; }
    }
  </style>
</head>
<body>
    <div id="menu">
        <svg viewBox="0 0 24 24"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
        <span>导航</span>
    </div>
<div class="list closed">
  <ul>
    <!-- AI 助手 -->
    <li class="title">AI 助手</li>
    <li><a href="https://www.qianwen.com/" target="_blank">通义千问</a></li>
    <li><a href="https://chatglm.cn/" target="_blank">智谱清言</a></li>
    <li><a href="https://www.doubao.com/" target="_blank">豆包</a></li>
    <li><a href="https://kimi.moonshot.cn/" target="_blank">Kimi</a></li>
    <li><a href="https://claude.ai/" target="_blank">Claude</a></li>
    <li><a href="https://chatgpt.com/" target="_blank">ChatGPT</a></li>

    <!-- 热点资讯 -->
    <li class="title">热点资讯</li>
    <li><a href="https://rebang.today/" target="_blank">今日热榜</a></li>
    <li><a href="https://tophub.today/" target="_blank">今日热榜</a></li>
    <li><a href="https://www.zhihu.com/" target="_blank">知乎</a></li>
    <li><a href="https://www.bilibili.com/" target="_blank">哔哩哔哩</a></li>

    <!-- 开发者社区 -->
    <li class="title">开发者社区</li>
    <li><a href="https://github.com/" target="_blank">GitHub</a></li>
    <li><a href="https://www.v2ex.com/" target="_blank">V2EX</a></li>
    <li><a href="https://stackoverflow.com/" target="_blank">Stack Overflow</a></li>
    <li><a href="https://juejin.cn/" target="_blank">掘金</a></li>
    <li><a href="https://www.csdn.net/" target="_blank">CSDN</a></li>  <!-- 已修正 -->

    <!-- 实用工具 -->
    <li class="title">实用工具</li>
    <li><a href="https://cn.bing.com/dict" target="_blank">Bing词典</a></li>
    <li><a href="https://www.remove.bg/" target="_blank">Remove.bg</a></li>
    <li><a href="https://smallpdf.com/cn" target="_blank">Smallpdf</a></li>
    <li><a href="https://www.iconfont.cn/" target="_blank">Iconfont</a></li> 

    <!-- 购物平台 -->
    <li class="title">购物平台</li>
    <li><a href="https://www.taobao.com/" target="_blank">淘宝</a></li>
    <li><a href="https://www.jd.com/" target="_blank">京东</a></li>
    <li><a href="https://www.pinduoduo.com/" target="_blank">拼多多</a></li>

    <!-- 学习资源 -->
    <li class="title">学习资源</li>
    <li><a href="https://www.coursera.org/" target="_blank">Coursera</a></li>
    <li><a href="https://www.bilibili.com/mooc/" target="_blank">B站课堂</a></li>
    <li><a href="https://www.icourse163.org/" target="_blank">中国大学MOOC</a></li>
    <li><a href="https://www.khanacademy.org/" target="_blank">可汗学院</a></li>

    <!-- 效率办公 -->
    <li class="title">效率办公</li>
    <li><a href="https://docs.qq.com/" target="_blank">腾讯文档</a></li>
    <li><a href="https://www.feishu.cn/" target="_blank">飞书</a></li>  <!-- 已修正 -->
    <li><a href="https://www.yuque.com/" target="_blank">语雀</a></li>
    <li><a href="https://notion.so/" target="_blank">Notion</a></li>
  </ul>
</div>


    <div class="landscape-container">
        <div class="mountain-layer layer-1"></div>
        <div class="mountain-layer layer-2"></div>
        <div class="mountain-layer layer-3"></div>
        <div class="fog"></div>
    </div>
    
    <div id="content">
        <div class="con">
            <div class="shlogo calligraphy-font">
                <div id="poem_sentence" class="poem-sentence">载酒买花年少事...</div>
                <div id="poem_info" class="poem-info">【宋】</div>
            </div>
            <div class="sou">
                <form id="searchForm" action="https://cn.bing.com/search" method="get" target="_blank">
                    <input type="text" id="searchInput" class="wd" name="q" placeholder="在 Bing 中搜索..." autocomplete="off">
                    <div class="sou-btn">
                        <svg class="icon-svg" viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zm0-8c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3z"/></svg>
                    </div>
                </form>
                <ul>
                    <li class="engine-tag" data-s="baidu">百度</li>
                    <li class="engine-tag active" data-s="bing">Bing</li>
                    <li class="engine-tag" data-s="duck">Duck</li>
                    <li class="engine-tag" data-s="google">Google</li>
                </ul>
            </div>
            <div class="dashboard-container">
                <div class="glass-card calendar-panel">
                    <div class="cal-header">
                        <div class="cal-title" id="monthYear">加载中...</div>
                        <div>
                            <button class="cal-nav-btn" id="prevBtn">&lt;</button>
                            <button class="cal-nav-btn" id="todayBtn" style="width:40px;">今天</button>
                            <button class="cal-nav-btn" id="nextBtn">&gt;</button>
                        </div>
                    </div>
                    <div class="cal-grid">
                        <div class="cal-weekday">日</div><div class="cal-weekday">一</div><div class="cal-weekday">二</div>
                        <div class="cal-weekday">三</div><div class="cal-weekday">四</div><div class="cal-weekday">五</div><div class="cal-weekday">六</div>
                    </div>
                    <div id="calendarDays" class="cal-grid" style="margin-top:5px;"></div>
                </div>
                <div class="glass-card time-panel">
                    <div class="time-clock" id="clockDisplay">00:00:00</div>
                    <div class="time-ganzhi" id="ganzhiDisplay">计算中...</div>
                    <div class="time-solar" id="solarDisplay">--</div>
                    <div class="time-date" id="dateDisplay">----年--月--日</div>
                </div>
            </div>
        </div>
        <div class="foot">© 2026 by <a href="http://2026.shici.online/"> 有Bing呀 </a> . All rights reserved.</div>
    </div>

    <script>
    // --- 1. 调试信息 ---
    console.log('Script Loaded Successfully!');

    // --- 1.1 全局辅助函数 ---
    const solarMonth = ["正", "二", "三", "四", "五", "六", "七", "八", "九", "十", "冬", "腊"];
    const tianGan = ["甲", "乙", "丙", "丁", "戊", "己", "庚", "辛", "壬", "癸"];
    const diZhi = ["子", "丑", "寅", "卯", "辰", "巳", "午", "未", "申", "酉", "戌", "亥"];

    function toChinaDay(d) {
        const tian = ['', '一', '二', '三', '四', '五', '六', '七', '八', '九', '十'];
        if (d === 10) return '初十';
        if (d === 20) return '二十';
        if (d === 30) return '三十';
        if (d < 10) return '初' + tian[d];
        if (d < 20) return '十' + tian[d - 10];
        return '廿' + tian[d - 20];
    }

    // --- 2. 农历算法模块 ---
    const LunarCalendar = (function() {
        const lunarInfo = [
            0x04bd8, 0x04ae0, 0x0a570, 0x054d5, 0x0d260, 0x0d950, 0x16554, 0x056a0, 0x09ad0, 0x055d2, 
            0x04ae0, 0x0a5b6, 0x0a4d0, 0x0d250, 0x1d255, 0x0b540, 0x0d6a0, 0x0ada2, 0x095b0, 0x14977, 0x04970, 0x0a4b0, 0x0b4b5, 0x06a50, 0x06d40, 0x1ab54, 0x02b60, 0x09570, 0x052f2, 0x04970, 0x06566, 
            0x0d4a0, 0x0ea50, 0x06e95, 0x05ad0, 0x02b60, 0x186e3, 0x092e0, 0x1c8d7, 0x0c950, 0x0d4a0, 0x1d8a6, 0x0b550, 0x056a0, 0x1a5b4, 0x025d0, 0x092d0, 0x0d2b2, 0x0a950, 0x0b557, 0x06ca0, 0x0b550, 0x15355, 0x04da0, 0x0a5b0, 0x14573, 0x052b0, 0x0a9a8, 
            0x0e950, 0x06aa0, 0x0aea6, 0x0ab50, 0x04b60, 0x0aae4, 0x0a570, 0x05260, 0x0f263, 0x0d950, 0x05b57, 0x056a0, 0x096d0, 0x04dd5, 0x04ad0, 0x0a4d0, 0x0d4d4, 0x0d250, 0x0d558, 0x0b540, 0x0b6a0, 0x195a6, 0x095b0, 0x049b0, 0x0a974, 0x0a4b0, 0x0b27a, 0x06a50, 0x06d40, 0x0af46, 
            0x0ab60, 0x09570, 0x04af5, 0x04970, 0x064b0, 0x074a3, 0x0ea50, 0x06b58, 0x055c0, 0x0ab60, 0x096d5, 0x092e0, 0x0c960, 0x0d954, 0x0d4a0, 0x0da50, 0x07552, 0x056a0, 0x0abb7, 0x025d0, 0x092d0, 0x0cab5, 0x0a950, 0x0b4a0, 0x0baa4, 0x0ad50, 0x055d9, 0x04ba0, 0x0a5b0, 0x15176, 0x052b0, 0x0a930, 0x07954, 
            0x06aa0, 0x0ad50, 0x05b52, 0x04b60, 0x0a6e6, 0x0a4e0, 0x0d260, 0x0ea65, 0x0d530, 0x05aa0, 0x076a3, 0x096d0, 0x04afb, 0x04ad0, 0x0a4d0, 0x1d0b6, 0x0d250, 0x0d520, 0x0dd45, 0x0b5a0, 0x056d0, 0x055b2, 0x049b0, 0x0a577, 0x0a4b0, 0x0aa50, 0x1b255, 0x06d20, 0x0ada0, 0x14b63, 0x09370, 0x049f8, 0x04970, 0x064b0, 0x168a6, 0x0ea50, 0x06b20, 0x1a6c4, 
            0x0aae0, 0x0a2e0, 0x0d2e3, 0x0c960, 0x0d557, 0x0d4a0, 0x0da50, 0x05d55, 0x056a0, 0x0a6d0, 0x055d4, 0x052d0, 0x0a9b8, 0x0a950, 0x0b4a0, 0x0b6a6, 0x0ad50, 0x055a0, 0x0aba4, 0x0a5b0, 0x052b0, 0x0b273, 0x06930, 0x07337, 0x06aa0, 0x0ad50, 0x14b55, 0x04b60, 0x0a570, 0x054e4, 0x0d160, 0x0e968, 0x0d520, 0x0daa0, 0x16aa6, 0x056d0, 0x04ae0, 0x0a9d4, 0x0a2d0, 0x0d150, 0x0f252, 0x0d520
        ];
        function lYearDays(y) {
            let i, sum = 348;
            for (i = 0x8000; i > 0x8; i >>= 1) sum += (lunarInfo[y - 1900] & i) ? 1 : 0;
            return (sum + leapDays(y));
        }
        function leapDays(y) { if (leapMonth(y)) return ((lunarInfo[y - 1900] & 0x10000) ? 30 : 29); else return (0); }
        function leapMonth(y) { return (lunarInfo[y - 1900] & 0xf); }
        function monthDays(y, m) { return ((lunarInfo[y - 1900] & (0x10000 >> m)) ? 30 : 29); }
        function getFestival(m, d) { const lFestivals = {"1-1": "春节", "1-15": "元宵", "5-5": "端午", "7-7": "七夕", "7-15": "中元", "8-15": "中秋", "9-9": "重阳", "12-8": "腊八", "12-23": "小年"}; return lFestivals[`${m}-${d}`] || null; }
        function solar2lunar(y, m, d) {
            let i, leap = 0, temp = 0;
            let offset = (Date.UTC(y, m - 1, d) - Date.UTC(1900, 0, 31)) / 86400000;
            for (i = 1900; i < 2101 && offset > 0; i++) { temp = lYearDays(i); offset -= temp; }
            if (offset < 0) { offset += temp; i--; }
            const year = i; leap = leapMonth(i); let isLeap = false;
            for (i = 1; i < 13 && offset > 0; i++) {
                if (leap > 0 && i === (leap + 1) && isLeap === false) { --i; isLeap = true; temp = leapDays(year); }
                else { temp = monthDays(year, i); }
                if (isLeap === true && i === (leap + 1)) isLeap = false;
                offset -= temp;
            }
            if (offset === 0 && leap > 0 && i === leap + 1) { if (isLeap) { isLeap = false; } else { isLeap = true; --i; } }
            if (offset < 0) { offset += temp; --i; }
            return { lYear: year, lMonth: i, lDay: offset + 1, festival: getFestival(i, offset + 1) };
        }
        return { fromDate: function(date) { return solar2lunar(date.getFullYear(), date.getMonth() + 1, date.getDate()); } };
    })();

    // --- 3. 节气计算 (简化版) ---
    function getSolarTerm(month, day) {
        const terms = ["小寒", "大寒", "立春", "雨水", "惊蛰", "春分", "清明", "谷雨", "立夏", "小满", "芒种", "夏至", "小暑", "大暑", "立秋", "处暑", "白露", "秋分", "寒露", "霜降", "立冬", "小雪", "大雪", "冬至"];
        let idx = -1;
        if(month === 1 && Math.abs(day - 6) <= 1) idx = 0;
        if(month === 1 && Math.abs(day - 20) <= 1) idx = 1;
        if(month === 2 && Math.abs(day - 4) <= 1) idx = 2;
        if(month === 2 && Math.abs(day - 19) <= 1) idx = 3;
        if(month === 3 && Math.abs(day - 6) <= 1) idx = 4;
        if(month === 3 && Math.abs(day - 21) <= 1) idx = 5;
        if(month === 4 && Math.abs(day - 5) <= 1) idx = 6;
        if(month === 4 && Math.abs(day - 20) <= 1) idx = 7;
        if(month === 5 && Math.abs(day - 6) <= 1) idx = 8;
        if(month === 5 && Math.abs(day - 21) <= 1) idx = 9;
        if(month === 6 && Math.abs(day - 6) <= 1) idx = 10;
        if(month === 6 && Math.abs(day - 22) <= 1) idx = 11;
        if(month === 7 && Math.abs(day - 7) <= 1) idx = 12;
        if(month === 7 && Math.abs(day - 23) <= 1) idx = 13;
        if(month === 8 && Math.abs(day - 8) <= 1) idx = 14;
        if(month === 8 && Math.abs(day - 23) <= 1) idx = 15;
        if(month === 9 && Math.abs(day - 8) <= 1) idx = 16;
        if(month === 9 && Math.abs(day - 23) <= 1) idx = 17;
        if(month === 10 && Math.abs(day - 8) <= 1) idx = 18;
        if(month === 10 && Math.abs(day - 24) <= 1) idx = 19;
        if(month === 11 && Math.abs(day - 8) <= 1) idx = 20;
        if(month === 11 && Math.abs(day - 22) <= 1) idx = 21;
        if(month === 12 && Math.abs(day - 7) <= 1) idx = 22;
        if(month === 12 && Math.abs(day - 22) <= 1) idx = 23;
        return idx !== -1 ? terms[idx] : null;
    }

    // --- 4. 页面加载完成后执行 ---
    document.addEventListener('DOMContentLoaded', function() {
        
        /* --- 4.1 随机背景 --- */
		const bgs = [
			'bg-lotus', 'bg-apricot', 'bg-peach', 'bg-autumn', 'sunset', 'goose', 'rose',
			'bg-bamboo', 'mint', 'olive', 'teal',
			'bg-cloud', 'sky', 'ocean',
			'lavender', 'wisteria', 'foggy'
		];
		document.body.classList.add(bgs[Math.floor(Math.random() * bgs.length)]);


        /* --- 4.2 诗词加载 --- */
        if (typeof jinrishici !== 'undefined') {
            jinrishici.load(function(result) {
                if(result.status === 'success' && result.data) {
                    const sentenceEl = document.getElementById('poem_sentence');
                    const infoEl = document.getElementById('poem_info');
                    if(sentenceEl && infoEl) {
                        sentenceEl.textContent = result.data.content;
                        infoEl.textContent = `【${result.data.origin.dynasty}】${result.data.origin.author}`;
                    }
                }
            });
        }

        /* --- 4.3 搜索引擎切换 --- */
        const engineTags = document.querySelectorAll('.engine-tag');
        const searchForm = document.getElementById('searchForm');
        const searchInput = document.getElementById('searchInput');
        if(engineTags && searchForm && searchInput) {
            engineTags.forEach(tag => {
                tag.addEventListener('click', function() {
                    const engine = this.getAttribute('data-s');
                    engineTags.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    if (engine === 'baidu') {
                        searchForm.action = 'https://www.baidu.com/s'; searchInput.name = 'wd'; searchInput.placeholder = '百度一下，你就知道';
                    } else if (engine === 'bing') {
                        searchForm.action = 'https://cn.bing.com/search'; searchInput.name = 'q'; searchInput.placeholder = '在 Bing 中搜索...';
                    } else if (engine === 'duck') {
                        searchForm.action = 'https://duckduckgo.com/'; searchInput.name = 'q'; searchInput.placeholder = 'DuckDuckGo Search';
                    } else if (engine === 'google') {
                        searchForm.action = 'https://www.google.com/search'; searchInput.name = 'q'; searchInput.placeholder = 'Google 搜索';
                    }
                });
            });
        }

        /* --- 4.4 菜单逻辑 --- */
        const menu = document.getElementById('menu');
        const list = document.querySelector('.list');
        if(menu && list) {
            menu.addEventListener('click', () => {
                menu.classList.toggle('on');
                list.classList.toggle('closed');
            });
        }

        /* --- 4.5 日历逻辑 --- */
        let cMonth = new Date().getMonth();
        let cYear = new Date().getFullYear();
        
        function renderCal(y, m) {
            const now = new Date();
            const isCur = now.getFullYear() === y && now.getMonth() === m;
            const fd = new Date(y, m, 1).getDay();
            const dim = new Date(y, m + 1, 0).getDate();
            let html = "";
            for (let i = 0; i < fd; i++) html += "<div></div>";
            for (let i = 1; i <= dim; i++) {
                let cls = "cal-day";
                try {
                    let lunarData = LunarCalendar.fromDate(new Date(y, m, i));
                    if (isCur && i === now.getDate()) cls += " today";
                    if (lunarData && lunarData.festival) {
                        html += `<div class="${cls} has-festival">${i}<span class="cal-lunar">${lunarData.festival}</span></div>`;
                    } else if (lunarData && lunarData.lDay === 1) {
                        cls += " lunar-first";
                        html += `<div class="${cls}">${i}<span class="cal-lunar">${solarMonth[lunarData.lMonth-1]}月</span></div>`;
                    } else {
                        html += `<div class="${cls}">${i}<span class="cal-lunar">${toChinaDay(lunarData.lDay)}</span></div>`;
                    }
                } catch(e) { html += `<div class="${cls}">${i}</div>`; }
            }
            const calendarEl = document.getElementById('calendarDays');
            if(calendarEl) {
                calendarEl.innerHTML = html;
                document.getElementById('monthYear').textContent = y + "年 " + (m + 1) + "月";
            }
        }
        try { renderCal(cYear, cMonth); } catch(e) { console.error("Render Calendar Failed", e); }
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const todayBtn = document.getElementById('todayBtn');
        if(prevBtn) prevBtn.addEventListener('click', () => { cMonth--; if(cMonth<0){cMonth=11;cYear--;}renderCal(cYear,cMonth); });
        if(nextBtn) nextBtn.addEventListener('click', () => { cMonth++; if(cMonth>11){cMonth=0;cYear++;}renderCal(cYear,cMonth); });
        if(todayBtn) todayBtn.addEventListener('click', () => { const n=new Date(); cYear=n.getFullYear(); cMonth=n.getMonth(); renderCal(cYear,cMonth); });

        /* --- 4.6 时间板块逻辑 --- */
        function initTime() {
            const clockEl = document.getElementById('clockDisplay');
            const ganzhiEl = document.getElementById('ganzhiDisplay');
            const solarEl = document.getElementById('solarDisplay');
            const dateEl = document.getElementById('dateDisplay');
            
            function update() {
                const now = new Date();
                const y = now.getFullYear();
                const m = now.getMonth();
                const d = now.getDate();
                const h = now.getHours();
                const minute = now.getMinutes();
                const second = now.getSeconds();

                const hStr = String(h).padStart(2, '0');
                const mStr = String(minute).padStart(2, '0');
                const sStr = String(second).padStart(2, '0');
                if(clockEl) clockEl.textContent = `${hStr}:${mStr}:${sStr}`;

                if(dateEl) dateEl.textContent = `${y}年${m+1}月${d}日`;

                const shichenIndex = (h % 2 === 0) ? (h/2) : Math.floor(h/2);
                const shichen = diZhi[shichenIndex];
                
                const yearGan = tianGan[(y - 4) % 10];
                const yearZhi = diZhi[(y - 4) % 12];
                
                let lunarData = {};
                try { lunarData = LunarCalendar.fromDate(now); } catch(e) {}
                
                const monthGan = tianGan[((y * 12 + m + (lunarData.lMonth || 0)) % 10)];
                const monthZhi = diZhi[(m + 1) % 12];
                
                const baseDate = new Date(1900, 0, 1);
                const offset = Math.floor((now - baseDate) / 86400000);
                const dayGan = tianGan[offset % 10];
                const dayZhi = diZhi[offset % 12];

                if(ganzhiEl) ganzhiEl.textContent = `${yearGan}${yearZhi}年 ${monthGan}${monthZhi}月 ${dayGan}${dayZhi}日 ${shichen}时`;

                const term = getSolarTerm(m + 1, d);
                if(solarEl) {
                    if (term) {
                        solarEl.textContent = term;
                        solarEl.style.display = "inline-block";
                    } else {
                        solarEl.textContent = "";
                        solarEl.style.display = "none";
                    }
                }
            }
            setInterval(update, 1000);
            update();
        }
        initTime();
    });
    </script>
</body>
</html>
